<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Adding data to Leaflet - Introduction to mapping and spatial methods for the humanities</title>
    <meta name="generator" content="Hugo 0.20.7" />

    
    <meta name="description" content="Tutorial designed for DHSITE 2017 in Ottawa.">
    
    <link rel="canonical" href="/adding-data-to-leaflet/">
    
    <meta name="author" content="Sarah Simpkin">
    

    <meta property="og:url" content="/adding-data-to-leaflet/">
    <meta property="og:title" content="Introduction to mapping and spatial methods for the humanities">
    <meta property="og:image" content="/images/logo.jpg">
    <meta name="apple-mobile-web-app-title" content="Introduction to mapping and spatial methods for the humanities">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('/fonts/icon.eot');
        src: url('/fonts/icon.eot')
               format('embedded-opentype'),
             url('/fonts/icon.woff')
               format('woff'),
             url('/fonts/icon.ttf')
               format('truetype'),
             url('/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="/stylesheets/application.css">
    <link rel="stylesheet" href="/stylesheets/temporary.css">
    <link rel="stylesheet" href="/stylesheets/palettes.css">
    <link rel="stylesheet" href="/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-cyan palette-accent-amber">




<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Adding data to Leaflet
      </div>
    </div>

    
    <div class="button button-twitter" role="button" aria-label="Twitter">
       <a href="https://twitter.com/sarahsimpkin" title="@sarahsimpkin on Twitter" target="_blank" class="toggle-button icon icon-twitter"></a>
    </div>
    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/ssimpkin" title="@ssimpkin on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="/" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="/images/logo.jpg">
        </div>
      
      <div class="name">
        <strong>Introduction to mapping and spatial methods for the humanities </strong>
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Welcome" href="/">
	
	Welcome
</a>



  
</li>



<li>
  
    



<a  title="Getting started" href="/getting-started/">
	
	Getting started
</a>



  
</li>



<li>
  
    



<a  title="Geospatial data" href="/geospatial-data/">
	
	Geospatial data
</a>



  
</li>



<li>
  
    



<a  title="CSV to GeoJSON" href="/csv-to-geojson/">
	
	CSV to GeoJSON
</a>



  
</li>



<li>
  
    



<a  title="Georectifying maps" href="/georectifying-maps/">
	
	Georectifying maps
</a>



  
</li>



<li>
  
    



<a class="current" title="Adding data to Leaflet" href="/adding-data-to-leaflet/">
	
	Adding data to Leaflet
</a>


<ul id="scrollspy">
</ul>


  
</li>



<li>
  
    



<a  title="Building exhibits" href="/building-exhibits/">
	
	Building exhibits
</a>



  
</li>


        </ul>
        

        
        <hr>
        <span class="section">The author</span>
        
        <ul>
          
          <li>
            <a href="https://twitter.com/sarahsimpkin" target="_blank" title="@sarahsimpkin on Twitter">
              @sarahsimpkin on Twitter
            </a>
          </li>
          

          
          <li>
            <a href="https://github.com/ssimpkin" target="_blank" title="@ssimpkin on GitHub">
              @ssimpkin on GitHub
            </a>
          </li>
          

          
          <li>
            <a href="mailto:sarahsimpkin@gmail.com" title="Email of sarahsimpkin@gmail.com">
              Contact via email
            </a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Adding data to Leaflet </h1>

			

<h2 id="overview">Overview</h2>

<p><a href="http://leafletjs.com/">Leaflet</a> is an open-source web mapping library that can display vector data (points, lines, and polygons) as well as raster overlays like our georectified maps. This intermediate-level exercise is designed to show how our different types of data can be integrated into a single interactive webmap.</p>

<h3 id="data-files">Data files</h3>

<ul>
<li><a href="/files/leaflet-demo/businesses.geojson">GeoJSON file with Rideau Street businesses</a></li>
<li><a href="/files/leaflet-demo.zip">Leaflet example folder</a></li>
</ul>

<h3 id="recommended-software">Recommended software</h3>

<ul>
<li><a href="https://www.sublimetext.com">Sublime Text</a></li>
<li><a href="http://www.pythonforbeginners.com/modules-in-python/how-to-use-simplehttpserver/">SimpleHTTPServer</a> (Mac), <a href="http://www.mamp.info/en/">MAMP</a> (Mac) or <a href="http://www.wampserver.com/en/">WampServer</a> (Windows)</li>
</ul>

<div class="admonition warning">
<p class="admonition-title">Watch out</p>
<p>We&rsquo;ll be creating offline Leaflet maps in this exercise, but it will be necessary to set up a local web server to load the data files (if your points don&rsquo;t appear after the test in step one, this is probably why). Options include running <a href="http://www.pythonforbeginners.com/modules-in-python/how-to-use-simplehttpserver/">SimpleHTTPServer</a> in your Leaflet example folder, or installing <a href="http://www.mamp.info/en/">MAMP</a> (Mac) or <a href="http://www.wampserver.com/en/">WampServer</a> (Windows).</p>
</div>

<h2 id="starting-a-web-server-mac">Starting a web server (Mac)</h2>

<p>First, download the leaflet-demo folder. Save it to your computer in an easily accessible location. I recommend adding the folder to your home directory, which you can open with the shortcut <code>Shift - Command - H</code>.</p>

<p>A local web server is necessary to run Leaflet offline in your browser. There&rsquo;s a Python-based one that is built into Mac computers called SimpleHTTPServer. It is a command line tool (but don&rsquo;t be afraid!).</p>

<p>Open a Terminal window by searching for &ldquo;Terminal&rdquo; in the Spotlight Search. You&rsquo;ll see a prompt where commands can be entered.</p>

<p>For this exercise, we need to navigate to the leaflet-demo folder to launch SimpleHTTPServer. If the leaflet-demo folder is in your home directory, it should be visible when we list the files.</p>

<p>Type <code>cd</code> in the prompt and press enter. This will make sure you start in the home directory.</p>

<p>Type <code>ls</code> in the prompt and press enter. This will list the contents of the directory.</p>

<p>If you see leaflet-demo in the list, navigate to it by typing <code>cd leaflet-demo</code> and pressing enter.</p>

<p>Next, type <code>python -m SimpleHTTPServer 8000</code> and press enter to launch the web server. We&rsquo;ll keep the terminal window open in the background while we work on our Leaflet map.</p>

<p>To make sure everything is configured correctly, navigate to <code>localhost:8000/leaflet-test.html</code> in your web browser. You should see a map of Ottawa with points showing the Rideau Street businesses. Clicking on the points will open a pop-up window showing more details about the businesses. We&rsquo;ll be recreating this map today.</p>

<h2 id="starting-a-web-server-windows">Starting a web server (Windows)</h2>

<p>Download and install <a href="http://www.wampserver.com/en/">WampServer</a>. You may be prompted to select your preferred web browser and text editor.</p>

<p>Launch WampServer from the Start menu. A green &ldquo;W&rdquo; icon should appear in your taskbar. Click on it and navigate to the <code>www</code> directory.</p>

<p>Next, download the leaflet-demo folder, unzip it and move it to the <code>www</code> directory.</p>

<p>Click on the green &ldquo;W&rdquo; icon again and click on <code>localhost</code>. This will launch your web browser. Navigate to <code>localhost/leaflet-demo/leaflet-test.html</code>. You should see a map of Ottawa with points showing the Rideau Street businesses. Clicking on the points will open a pop-up window showing more details about the businesses. We&rsquo;ll be recreating this map today.</p>

<p><img src="/images/windows-map.jpg" alt="Web map of Ottawa showing 1890-era businesses" /></p>

<h2 id="setting-up-your-map">Setting up your map</h2>

<p>We&rsquo;ll be looking at a series of steps that build on each other to create a simple webmap.</p>

<p>Navigate to the <code>leaflet-demo</code> folder, then right click on the <code>01.html</code> file. Open it with a text editor, such as Sublime Text, Notepad (Windows), or TextEdit (Mac).</p>

<p>There are a few things happening in this code block.</p>

<pre><code class="language-html```">&lt;!-- 
  ****************************************************************************
  Leaflet demo map by Sarah Simpkin / sarahsimpkin@gmail.com
  Based on a tutorial by Andy Woodruff and Ryan Mullins: http://maptimeboston.github.io/leaflet-intro/
  STEP 1: Setting up the map
  ****************************************************************************
--&gt;

&lt;!-- ~ HTML code to set up the page where the map will go ~ --&gt;
</code></pre>

<p>First, we use HTML code to provide some comments about the code we&rsquo;re using. Anything appearing between <code>&lt;!--</code> and <code>--&gt;</code> is considered a comment and will be invisible on the final webmap.</p>

<pre><code class="language-html">&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;Ottawa web map&lt;/title&gt;
</code></pre>

<p>Next, HTML code is used to give the page a title between the <code>&lt;title&gt;</code> and <code>&lt;/title&gt;</code> tags.</p>

<pre><code class="language-html">&lt;link rel=&quot;stylesheet&quot; href=&quot;http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css&quot;/&gt;
  &lt;script src=&quot;http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;jquery-2.1.1.min.js&quot;&gt;&lt;/script&gt;
</code></pre>

<p>Our webmap relies on some external styles and scripts. These are linked on the first few lines.</p>

<pre><code class="language-css">      body { margin:0; padding:0; }
      #map { position:absolute; top:0; bottom:0; left:0; right:0; width:100%; }
</code></pre>

<p>Next, our webmap is given some dimensions on the page. Ours will take up the full browser window, so the margins have been set to 0 and the width has been set to 100%.</p>

<pre><code class="language-html">&lt;div id=&quot;map&quot;&gt;&lt;/div&gt;
</code></pre>

<p>A <code>&lt;div&gt;</code> element is created to hold our map.</p>

<pre><code>  var map = L.map('map').setView([45.42621, -75.69243], 19);
</code></pre>

<p>Then the map is added and customized using Javascript. The view is set to focus on our desired coordinates (in this case, the corner of Rideau Street and Sussex Drive). The zoom level (set to 19) will zoom in the map to show the buildings up close. You can zoom out the default view by reducing this number.</p>

<pre><code>  L.tileLayer('http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png',
    {
      attribution: '&amp;copy; &lt;a href=&quot;http://www.openstreetmap.org/copyright&quot;&gt;OpenStreetMap&lt;/a&gt; &amp;copy; &lt;a href=&quot;http://cartodb.com/attributions&quot;&gt;CartoDB&lt;/a&gt;',
      maxZoom: 20,
      minZoom: 1
    }).addTo(map);
</code></pre>

<p>To give the map a basemap layer showing streets, a tilelayer is loaded from the web. I&rsquo;ve chosen a light grey basemap from CartoDB, but other basemaps are available for free online. A useful site for previewing these options is the <a href="https://leaflet-extras.github.io/leaflet-providers/preview/">Leaflet-providers preview</a>. It&rsquo;s important to acknowledge where the basemap layer came from, so Leaflet provides a space to include attribution information. You can also specify which levels of zoom should be available.</p>

<p><strong>Example 1 shows a light grey basemap from CartoDB</strong>
<iframe src="/files/leaflet-demo/01.html" width="100%" height="540"> </iframe></p>

<h2 id="adding-a-geojson-file">Adding a GeoJSON file</h2>

<p>Next, examine <code>02.html</code> in your text editor.</p>

<pre><code>  // ~ Loads a GeoJSON file with our points ~
  $.getJSON(&quot;businesses.geojson&quot;,function(data){
    L.geoJson(data, {
      pointToLayer: function(feature,latlng){
        var marker = L.marker(latlng);
        return marker;
      }
    }).addTo(map);
</code></pre>

<p>This new section of code is responsible for bringing in the <code>businesses.geojson</code> file that is located in the same directory as the leaflet map. It reads the information in the file and adds markers on each point.</p>

<p><strong>Example 2 showing point data from businesses.geojson</strong>
<iframe src="/files/leaflet-demo/02.html" width="100%" height="540"> </iframe></p>

<h2 id="adding-pop-ups">Adding pop-ups</h2>

<p>To make the map more dynamic, we can add pop-ups to each marker that reveal more information about each business.</p>

<p>Open <code>03.html</code> in your text editor.</p>

<pre><code>// ~ Make a pop-up, configure which attributes to display
        marker.bindPopup('&lt;strong&gt;' + feature.properties.business_name + '&lt;/strong&gt;&lt;/br&gt;' + feature.properties.description); 
</code></pre>

<p>Only one line of code is required to bind the pop-ups to the markers. This section of code creates the pop-ups and specifies their content: two fields from <code>businesses.geojson</code> called <code>business_name</code> and <code>description</code>. I&rsquo;ve wrapped the business name in <code>&lt;strong&gt;</code> tags to make them appear in bold on the final map.</p>

<p><strong>Example 3 with pop-ups</strong>
<iframe src="/files/leaflet-demo/03.html" width="100%" height="540"> </iframe></p>

<h2 id="adding-an-overlay-map">Adding an overlay map</h2>

<p>We can also include raster imagery from sources such as Map Warper.</p>

<p><img src="/images/mapwarper-export.jpeg" alt="Export screen from Map Warper showing links" /></p>

<p>Open a georectified map in <a href="http://mapwarper.net">Map Warper</a>.</p>

<p>Click on the <code>Export</code> tab, then copy the address in the <code>Tiles (Google/OSM scheme)</code> field.</p>

<p>The URL should look something like <code>http://mapwarper.net/maps/tile/20531/{z}/{x}/{y}.png</code>.</p>

<p>This address can be pasted in the following code snippet to bring the image tiles into our Leaflet map. Just like the basemap layer, we can add attribution information and specify which zoom levels the imagery should appear in.</p>

<pre><code>  // ~ Loads a tile layer from Map Warper ~
  L.tileLayer('http://mapwarper.net/maps/tile/20531/{z}/{x}/{y}.png',
    {
      attribution: 'Tiles by &lt;a href=&quot;http://mapwarper.net/maps/20531&quot;&gt;Map Warper user sarahsimpkin&lt;/a&gt;',
      maxZoom: 20,
      minZoom: 1
    }).addTo(map);
</code></pre>

<p><strong>Example 4 showing the raster overlay</strong>
<iframe src="/files/leaflet-demo/04.html" width="100%" height="540"> </iframe></p>


			<aside class="copyright" role="note">
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="/georectifying-maps/" title="Georectifying maps">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Georectifying maps
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="/building-exhibits/" title="Building exhibits">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Building exhibits
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

